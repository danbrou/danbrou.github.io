<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seattle Public Pool Lap Swim Schedule</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc; /* Very light blue/gray background */
        }
        /* Hide the default checkbox input visually for day/pool toggles */
        .filter-input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        /* Style the label (the visual "button") */
        .filter-label {
            cursor: pointer;
            user-select: none;
            text-align: center;
            line-height: 1;
            transition: all 0.2s;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white shadow-2xl rounded-xl overflow-hidden">

        <!-- Header -->
        <header class="p-6 md:p-8 bg-blue-600 text-white">
            <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight mb-2">
                Seattle Public Pool Lap Swim
            </h1>
            <p class="text-blue-200 text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1A1.5 1.5 0 0014 16.5v-1.5z" />
                </svg>
                Current Schedules for Seattle Pools
            </p>
        </header>

        <!-- Schedule Container -->
        <div class="p-6 md:p-8">
            <p class="text-gray-600 mb-6 border-l-4 border-blue-400 pl-3 text-sm md:text-base">
                **Pool | Day | Time | Lanes** is the main summary. Details for each session are listed below it.
            </p>

            <!-- Filter Panel -->
            <div class="bg-gray-100 p-4 rounded-lg mb-6 shadow-inner">
                <h2 class="text-xl font-bold text-gray-800 mb-4">Filter Options</h2>
                
                <!-- Pool Checkboxes -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Filter by Pool:</label>
                    <div id="pool-filters" class="flex flex-wrap gap-2">
                        <!-- Pool toggles will be dynamically generated by JS -->
                    </div>
                </div>

                <!-- Day Checkboxes -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Filter by Day:</label>
                    <div id="day-filters" class="flex flex-wrap gap-1">
                        <!-- Compact toggles will be dynamically generated by JS -->
                    </div>
                </div>

                <!-- Time Dropdowns -->
                <div class="grid grid-cols-2 gap-4">
                    <!-- Start Time Filter -->
                    <div>
                        <label for="start-time-filter" class="block text-sm font-medium text-gray-700 mb-1">Min Start Time:</label>
                        <select id="start-time-filter" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base p-2"></select>
                    </div>

                    <!-- End Time Filter -->
                    <div>
                        <label for="end-time-filter" class="block text-sm font-medium text-gray-700 mb-1">Max End Time:</label>
                        <select id="end-time-filter" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base p-2"></select>
                    </div>
                </div>
            </div>
            <!-- End Filter Panel -->


            <!-- Schedule Grid/Table Headers (Visible on Medium screens and up) -->
            <!-- Adjusted column spans for the new 'Pool' column (2+2+3+2+3 = 12) -->
            <div class="hidden md:grid grid-cols-12 font-bold text-sm uppercase tracking-wider text-blue-700 border-b-2 border-blue-200 pb-3 mb-3">
                <div class="col-span-2">Pool</div>
                <div class="col-span-2">Day</div>
                <div class="col-span-3">Time</div>
                <div class="col-span-2 text-center">Lanes</div>
                <div class="col-span-3">Details</div>
            </div>

            <!-- Schedule Data -->
            <div id="schedule-list">
                <!-- Data will be injected here by JavaScript -->
            </div>
            
            <p class="mt-8 text-sm text-gray-500 text-center pt-4 border-t border-gray-100">
                Always check with the front desk for same-day updates or closures.
            </p>
        </div>

    </div>

    <script>
        // --- Day and Pool Order Constants ---
        const daysOfWeek = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
        const dayOrder = { 
            "Monday": 0, "Tuesday": 1, "Wednesday": 2, "Thursday": 3, 
            "Friday": 4, "Saturday": 5, "Sunday": 6 
        };
        const poolOrder = {
            "Evans Pool": 0,
            "Queen Anne Pool": 1
        };

        // --- Utility Functions ---

        // Converts time string to total minutes from midnight
        const parseTime = (timeStr) => {
            const [time, period] = timeStr.split(' ');
            let [hours, minutes] = time.split(':').map(Number);
            
            if (period === 'PM' && hours !== 12) {
                hours += 12;
            } else if (period === 'AM' && hours === 12) {
                hours = 0;
            }
            return hours * 60 + minutes; 
        };

        // Converts total minutes to HH:MM AM/PM string
        const minutesToTime = (minutes) => {
            const totalMinutes = minutes % 1440;
            let hours = Math.floor(totalMinutes / 60);
            const mins = totalMinutes % 60;
            const period = hours >= 12 ? 'PM' : 'AM';

            if (hours === 0) {
                hours = 12;
            } else if (hours > 12) {
                hours -= 12;
            }
            
            const minutesStr = mins.toString().padStart(2, '0');
            return `${hours}:${minutesStr} ${period}`;
        };

        // Function to generate time options in 30-minute increments (6:00 AM to 10:00 PM)
        const generateTimeOptions = () => {
            const options = [];
            // Start at 6:00 AM (360 min) up to 10:00 PM (1320 min)
            for (let minutes = 360; minutes <= 1320; minutes += 30) {
                options.push(minutes);
            }
            return options;
        };
        
        // Helper to expand day ranges (e.g., "Monday – Friday" -> ["Monday", "Tuesday", ...])
        const expandDayRange = (rangeStr) => {
            const days = [];
            const dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

            if (rangeStr.includes(' – ')) {
                const [startDayName, endDayName] = rangeStr.split(' – ');
                const startIndex = dayNames.indexOf(startDayName);
                const endIndex = dayNames.indexOf(endDayName);

                if (startIndex !== -1 && endIndex !== -1) {
                    for (let i = startIndex; i !== (endIndex + 1) % 7; i = (i + 1) % 7) {
                        days.push(dayNames[i]);
                    }
                    days.push(endDayName); // Add the final day
                }
            } else if (rangeStr.includes('/')) {
                return rangeStr.split('/');
            } else {
                days.push(rangeStr);
            }
            // Remove duplicates and ensure correct order (important if range logic failed to ensure unique days)
            return days.filter((value, index, self) => self.indexOf(value) === index).sort((a, b) => dayOrder[a] - dayOrder[b]);
        };


        // --- Schedule Data ---

        // Evans Pool Data (Existing, updated with pool key)
        const evansSchedule = [
            // Monday
            { pool: "Evans Pool", day: "Monday", time: "12:00 PM - 1:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            { pool: "Evans Pool", day: "Monday", time: "1:30 PM - 4:00 PM", lanes: 3, notes: "3 lap lanes, with Pool Playland" },
            { pool: "Evans Pool", day: "Monday", time: "6:30 PM - 8:00 PM", lanes: 6, notes: "6 lap lanes" },
            // Tuesday
            { pool: "Evans Pool", day: "Tuesday", time: "12:00 PM - 1:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            { pool: "Evans Pool", day: "Tuesday", time: "1:30 PM - 4:00 PM", lanes: 3, notes: "3 lap lanes, with Pool Playland" },
            { pool: "Evans Pool", day: "Tuesday", time: "6:30 PM - 7:00 PM", lanes: 4, notes: "4 lap lanes (part of 6:30-8:00 slot)" },
            { pool: "Evans Pool", day: "Tuesday", time: "7:00 PM - 8:00 PM", lanes: 6, notes: "6 lap lanes (part of 6:30-8:00 slot)" },
            // Wednesday
            { pool: "Evans Pool", day: "Wednesday", time: "11:00 AM - 12:00 PM", lanes: 3, notes: "3 lap lanes (No open pool)" },
            { pool: "Evans Pool", day: "Wednesday", time: "12:00 PM - 1:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            { pool: "Evans Pool", day: "Wednesday", time: "1:30 PM - 4:00 PM", lanes: 3, notes: "3 lap lanes, with Pool Playland" },
            { pool: "Evans Pool", day: "Wednesday", time: "7:30 PM - 8:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            // Thursday
            { pool: "Evans Pool", day: "Thursday", time: "12:00 PM - 1:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            { pool: "Evans Pool", day: "Thursday", time: "1:30 PM - 4:00 PM", lanes: 3, notes: "3 lap lanes, with Pool Playland" },
            { pool: "Evans Pool", day: "Thursday", time: "6:30 PM - 8:00 PM", lanes: 6, notes: "6 lap lanes" },
            // Friday
            { pool: "Evans Pool", day: "Friday", time: "11:00 AM - 12:00 PM", lanes: 3, notes: "3 lap lanes (No open pool)" },
            { pool: "Evans Pool", day: "Friday", time: "12:00 PM - 1:30 PM", lanes: 3, notes: "3 lap lanes, with Adult Swim" },
            { pool: "Evans Pool", day: "Friday", time: "1:30 PM - 3:00 PM", lanes: 3, notes: "3 lap lanes, with Pool Playland" },
            { pool: "Evans Pool", day: "Friday", time: "6:15 PM - 7:15 PM", lanes: 4, notes: "4 lap lanes (No open pool)" },
            // Saturday
            { pool: "Evans Pool", day: "Saturday", time: "8:30 AM - 10:00 AM", lanes: 6, notes: "6 lap lanes" },
            { pool: "Evans Pool", day: "Saturday", time: "1:00 PM - 2:30 PM", lanes: 4, notes: "4 lap lanes (No open pool)" },
            { pool: "Evans Pool", day: "Saturday", time: "4:30 PM - 5:30 PM", lanes: 6, notes: "6 lap lanes" },
        ];
        
        // Queen Anne Pool Data (New)
        const queenAnneScheduleRaw = [
            { days: "Monday – Saturday", time: "11:30 AM - 1:00 PM", lanes: 3, notes: "3 Lap Lanes", pool: "Queen Anne Pool" },
            { days: "Monday – Friday", time: "1:00 PM - 2:25 PM", lanes: 6, notes: "6 Lap Lanes", pool: "Queen Anne Pool" },
            { days: "Monday – Thursday", time: "2:30 PM - 4:00 PM", lanes: 3, notes: "3 Lap Lanes", pool: "Queen Anne Pool" },
            { days: "Monday/Wednesday", time: "7:35 PM - 8:45 PM", lanes: 5, notes: "5 Lap Lanes", pool: "Queen Anne Pool" },
            { days: "Saturday", time: "7:30 AM - 8:55 AM", lanes: 6, notes: "Requires Quick Card, Exact Change or Check", pool: "Queen Anne Pool" },
            { days: "Saturday", time: "4:05 PM - 5:25 PM", lanes: 6, notes: "Requires Quick Card, Exact Change or Check", pool: "Queen Anne Pool" },
        ];
        
        let expandedQueenAnneSchedule = [];
        queenAnneScheduleRaw.forEach(slot => {
            const days = expandDayRange(slot.days);
            days.forEach(day => {
                expandedQueenAnneSchedule.push({
                    pool: slot.pool,
                    day: day,
                    time: slot.time,
                    lanes: slot.lanes,
                    notes: slot.notes
                });
            });
        });

        const swimmingSchedule = [...evansSchedule, ...expandedQueenAnneSchedule];

        // Sort the entire schedule by Pool, then Day, then Time
        const sortedSchedule = swimmingSchedule.sort((a, b) => {
            // 1. Primary Sort: Pool
            const poolA = poolOrder[a.pool];
            const poolB = poolOrder[b.pool];
            if (poolA !== poolB) {
                return poolA - poolB;
            }

            // 2. Secondary Sort: Day of the week
            const dayA = dayOrder[a.day];
            const dayB = dayOrder[b.day];
            if (dayA !== dayB) {
                return dayA - dayB;
            }

            // 3. Tertiary Sort: Time
            const timeA = parseTime(a.time.split(' - ')[0]);
            const timeB = parseTime(b.time.split(' - ')[0]);
            return timeA - timeB;
        });


        // --- DOM Elements ---
        const scheduleList = document.getElementById('schedule-list');
        const dayFiltersContainer = document.getElementById('day-filters');
        const poolFiltersContainer = document.getElementById('pool-filters');
        const startTimeFilter = document.getElementById('start-time-filter');
        const endTimeFilter = document.getElementById('end-time-filter');


        // --- Filter Initializers ---

        // 1. Initialize Compact Day Checkboxes
        const initializeDayFilters = () => {
            dayFiltersContainer.innerHTML = '';
            
            daysOfWeek.forEach(day => {
                const dayId = `day-${day}`;
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = dayId;
                checkbox.name = 'day';
                checkbox.value = day;
                checkbox.checked = true;
                checkbox.className = 'filter-input';
                checkbox.addEventListener('change', applyFilters);

                const label = document.createElement('label');
                label.htmlFor = dayId;
                label.textContent = day.substring(0, 1); 
                label.className = 'filter-label text-xs font-bold w-6 h-6 flex items-center justify-center rounded-full border border-blue-300';
                
                const updateLabelStyle = () => {
                     if (checkbox.checked) {
                        label.classList.add('bg-blue-600', 'text-white', 'shadow-md');
                        label.classList.remove('bg-white', 'text-blue-600', 'hover:bg-blue-100');
                    } else {
                        label.classList.remove('bg-blue-600', 'text-white', 'shadow-md');
                        label.classList.add('bg-white', 'text-blue-600', 'hover:bg-blue-100');
                    }
                };

                checkbox.addEventListener('change', updateLabelStyle);
                updateLabelStyle(); 

                dayFiltersContainer.appendChild(checkbox);
                dayFiltersContainer.appendChild(label);
            });
        };

        // 2. Initialize Pool Checkboxes (Similar compact style)
        const initializePoolFilters = () => {
            poolFiltersContainer.innerHTML = '';
            
            Object.keys(poolOrder).forEach(poolName => {
                const poolId = `pool-${poolName.replace(/\s/g, '-')}`;
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = poolId;
                checkbox.name = 'pool';
                checkbox.value = poolName;
                checkbox.checked = true;
                checkbox.className = 'filter-input';
                checkbox.addEventListener('change', applyFilters);

                const label = document.createElement('label');
                label.htmlFor = poolId;
                label.textContent = poolName; 
                label.className = 'filter-label text-sm px-3 py-1 rounded-full border border-blue-300';
                
                const updateLabelStyle = () => {
                     if (checkbox.checked) {
                        label.classList.add('bg-blue-600', 'text-white', 'shadow-md');
                        label.classList.remove('bg-white', 'text-blue-600', 'hover:bg-blue-100');
                    } else {
                        label.classList.remove('bg-blue-600', 'text-white', 'shadow-md');
                        label.classList.add('bg-white', 'text-blue-600', 'hover:bg-blue-100');
                    }
                };

                checkbox.addEventListener('change', updateLabelStyle);
                updateLabelStyle(); 

                poolFiltersContainer.appendChild(checkbox);
                poolFiltersContainer.appendChild(label);
            });
        };

        // 3. Initialize Time Dropdowns
        const initializeTimeFilters = () => {
            const timeOptions = generateTimeOptions();

            const createOption = (minutes) => {
                const timeStr = minutesToTime(minutes);
                const option = document.createElement('option');
                option.value = minutes;
                option.textContent = timeStr;
                return option;
            };

            startTimeFilter.innerHTML = '';
            timeOptions.forEach(minutes => {
                startTimeFilter.appendChild(createOption(minutes));
            });
            startTimeFilter.value = 360; 
            startTimeFilter.addEventListener('change', applyFilters);

            endTimeFilter.innerHTML = '';
            timeOptions.forEach(minutes => {
                endTimeFilter.appendChild(createOption(minutes));
            });
            endTimeFilter.value = 1320; 
            endTimeFilter.addEventListener('change', applyFilters);
        };


        // 4. Schedule Renderer
        const renderSchedule = (data) => {
            scheduleList.innerHTML = '';

            if (data.length === 0) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'text-center py-10 text-gray-500 italic text-lg';
                messageDiv.textContent = 'No swimming times match your current filter settings.';
                scheduleList.appendChild(messageDiv);
                return;
            }

            data.forEach((item, index) => {
                const bgColor = index % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                const itemDiv = document.createElement('div');
                
                // Lanes Badge Styling
                const lanesBadge = document.createElement('span');
                let laneColor = 'bg-gray-100 text-gray-700';
                if (item.lanes >= 6) {
                    laneColor = 'bg-green-100 text-green-800';
                } else if (item.lanes >= 4) {
                    laneColor = 'bg-yellow-100 text-yellow-800';
                } else if (item.lanes >= 1) {
                    laneColor = 'bg-red-100 text-red-800';
                }

                lanesBadge.className = `inline-block px-3 py-0.5 text-xs font-bold rounded-full ${laneColor}`;
                lanesBadge.textContent = item.lanes > 0 ? `${item.lanes} Lanes` : 'Closed';
            
                // Responsive Layout Logic
                if (window.innerWidth < 768) { 
                     // Mobile view: Pool, Day, Time, Lanes in a compact header, Details below.
                    itemDiv.className = `flex flex-col gap-y-1 py-2 px-4 rounded-lg transition duration-150 ease-in-out hover:shadow-md ${bgColor} border-b border-gray-100 last:border-b-0`;

                    // Pool Name (New in Mobile)
                    const poolTitle = document.createElement('div');
                    poolTitle.className = 'text-xs text-blue-600 font-bold mb-1 border-b border-blue-100 pb-1';
                    poolTitle.textContent = item.pool;
                    itemDiv.appendChild(poolTitle);

                    // Compact Header Row (Day, Time, Lanes)
                    const compactHeader = document.createElement('div');
                    compactHeader.className = 'flex justify-between items-center';

                    // Group Day and Time
                    const dayAndTime = document.createElement('div');
                    dayAndTime.className = 'flex-shrink-0';
                    dayAndTime.innerHTML = `<span class="font-semibold text-blue-800 mr-2 text-base">${item.day}:</span> <span class="text-sm text-gray-700">${item.time}</span>`;
                    
                    compactHeader.appendChild(dayAndTime);
                    compactHeader.appendChild(lanesBadge); 

                    // Notes (Details below)
                    const notesContainer = document.createElement('div');
                    notesContainer.className = 'text-xs text-gray-500 italic mt-0.5 border-t border-gray-200 pt-1 pl-2';
                    notesContainer.textContent = item.notes;

                    itemDiv.appendChild(compactHeader);
                    itemDiv.appendChild(notesContainer);

                } else {
                    // Desktop view (MD and up): 12-column grid (Pool | Day | Time | Lanes | Details)
                    itemDiv.className = `grid grid-cols-12 gap-y-0 gap-x-4 py-2 px-4 rounded-lg transition duration-150 ease-in-out hover:shadow-md ${bgColor} border-b border-gray-100 last:border-b-0`;

                    // 1. Pool
                    const poolDiv = document.createElement('div');
                    poolDiv.className = 'col-span-2 text-sm font-medium text-blue-600 truncate';
                    poolDiv.textContent = item.pool;

                    // 2. Day 
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'col-span-2 text-base font-semibold text-blue-800';
                    dayDiv.textContent = item.day;
                    
                    // 3. Time Slot 
                    const timeDiv = document.createElement('div');
                    timeDiv.className = 'col-span-3 text-sm text-gray-700';
                    timeDiv.textContent = item.time;

                    // 4. Lanes 
                    const lanesDiv = document.createElement('div');
                    lanesDiv.className = 'col-span-2 text-center text-sm'; 
                    lanesDiv.appendChild(lanesBadge); 
                    
                    // 5. Notes
                    const notesDiv = document.createElement('div');
                    notesDiv.className = 'col-span-3 text-sm text-gray-500 italic';
                    notesDiv.textContent = item.notes;

                    itemDiv.appendChild(poolDiv);
                    itemDiv.appendChild(dayDiv);
                    itemDiv.appendChild(timeDiv);
                    itemDiv.appendChild(lanesDiv);
                    itemDiv.appendChild(notesDiv);
                }
                
                scheduleList.appendChild(itemDiv);
            });
        };

        // 5. Apply Filters Function
        const applyFilters = () => {
            // Filter 1: Pool selection
            const selectedPools = Array.from(poolFiltersContainer.querySelectorAll('.filter-input[name="pool"]:checked'))
                                      .map(checkbox => checkbox.value);

            // Filter 2: Day selection
            const selectedDays = Array.from(dayFiltersContainer.querySelectorAll('.filter-input[name="day"]:checked'))
                                      .map(checkbox => checkbox.value);

            // Filter 3 & 4: Time range
            const minStartTime = parseInt(startTimeFilter.value, 10);
            const maxEndTime = parseInt(endTimeFilter.value, 10);

            const filteredSchedule = sortedSchedule.filter(item => {
                
                // Filter 1: Pool
                if (!selectedPools.includes(item.pool)) {
                    return false;
                }

                // Filter 2: Day of the Week
                if (!selectedDays.includes(item.day)) {
                    return false;
                }

                // Split time string and parse start and end times in minutes
                const timeParts = item.time.split(' - ');
                const startTimeStr = timeParts[0].trim();
                const endTimeStr = timeParts[1].trim();

                const slotStartTimeMinutes = parseTime(startTimeStr);
                const slotEndTimeMinutes = parseTime(endTimeStr);

                // Filter 3: Start Time (Slot must start ON OR AFTER selected min start time)
                if (slotStartTimeMinutes < minStartTime) {
                    return false;
                }

                // Filter 4: End Time (Slot must end ON OR BEFORE selected max end time)
                if (slotEndTimeMinutes > maxEndTime) {
                    return false;
                }
                
                return true;
            });

            renderSchedule(filteredSchedule);
        };

        // --- Initialization ---
        window.onload = function() {
            initializePoolFilters();
            initializeDayFilters();
            initializeTimeFilters();
            
            applyFilters(); 
            
            // Re-render mobile/desktop view on resize
            window.addEventListener('resize', applyFilters); 
        };
    </script>
</body>
</html>
